<!doctype html>
<html lang="pt-BR" prefix="og: http://ogp.me/ns#">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- SEO & Meta Tags -->
    <title>The Grid Social - Global Neural Network</title>
    <meta
      name="description"
      content="The Grid Social. Uma rede social minimalista baseada em localiza√ß√£o. Conecte-se ao mapa global."
    />
    <meta
      name="keywords"
      content="the grid, social network, map, cyberpunk, firebase, location based"
    />
    <link rel="canonical" href="https://thegridsocial.vercel.app" />
    <link rel="icon" href="https://fav.farm/üåç" />
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#050505" />

    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://thegridsocial.vercel.app/index.html"
    />
    <meta property="og:title" content="The Grid Social" />
    <meta
      property="og:description"
      content="Conecte-se √† rede neural global."
    />
    <meta
      property="og:image"
      content="https://thegridsocial.vercel.app/og-image.jpg"
    />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Leaflet CSS (Mapa) -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />

    <!-- html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- Fontes (Rajdhani - Tech/Futuristic) -->
    <link
      href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;500;700&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body class="overflow-hidden relative bg-black">
    <!-- Loading Screen -->
    <div
      id="loading-screen"
      class="fixed inset-0 bg-black z-[3000] flex flex-col items-center justify-center transition-opacity duration-700"
    >
      <div class="relative w-24 h-24">
        <div
          class="absolute inset-0 border-4 border-cyan-900/30 rounded-full"
        ></div>
        <div
          class="absolute inset-0 border-4 border-t-cyan-500 rounded-full animate-spin"
        ></div>
        <div
          class="absolute inset-4 border-4 border-cyan-900/30 rounded-full"
        ></div>
        <div
          class="absolute inset-4 border-4 border-b-cyan-400 rounded-full animate-spin-reverse"
        ></div>
        <div
          class="absolute inset-[38%] bg-cyan-500/20 rounded-full animate-pulse shadow-[0_0_15px_rgba(6,182,212,0.5)]"
        ></div>
      </div>
      <div
        class="mt-8 font-mono text-cyan-500 text-sm tracking-[0.3em] animate-pulse text-glow"
      >
        ESTABLISHING CONNECTION...
      </div>
    </div>

    <!-- Scanlines Overlay -->
    <div class="scanlines"></div>

    <!-- Ambient Audio -->
    <audio id="audio-ambience" loop>
      <source src="./sound.mp3" type="audio/mpeg" />
    </audio>

    <!-- Mapa de Fundo -->
    <div id="map"></div>

    <!-- FEED LATERAL (Novo Componente) -->
    <div
      id="feed-panel"
      class="feed-panel fixed top-0 left-0 h-full w-96 bg-black/90 backdrop-blur-md border-r border-cyan-500 z-[1500] flex flex-col pointer-events-auto shadow-[0_0_30px_rgba(6,182,212,0.2)]"
    >
      <div
        class="p-4 border-b border-cyan-900 flex justify-between items-center bg-cyan-900/20"
      >
        <h2
          class="text-xl font-bold text-cyan-400 uppercase tracking-widest text-glow"
        >
          /// THE FEED
        </h2>
        <button
          id="btn-close-feed"
          class="text-cyan-600 hover:text-white font-mono"
        >
          [X]
        </button>
      </div>

      <!-- Feed Content -->
      <div
        id="feed-content"
        class="flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar"
      >
        <!-- Messages injected via JS -->
        <div class="text-center text-cyan-800 font-mono text-xs mt-10">
          INITIALIZING FEED STREAM...
        </div>
      </div>

      <!-- Pagination Trigger -->
      <div class="p-4 border-t border-cyan-900 bg-black/50">
        <button
          id="btn-load-more"
          class="w-full border border-cyan-700 text-cyan-500 hover:bg-cyan-900/50 py-2 text-xs font-bold uppercase tracking-widest transition"
        >
          LOAD MORE DATA
        </button>
      </div>
    </div>

    <!-- UNIFIED UI CONTAINER -->
    <div
      id="main-ui-container"
      class="fixed inset-0 z-[1000] pointer-events-none flex flex-col justify-between p-2 sm:p-4 md:p-6 transition-opacity duration-500"
    >
      <!-- TOP BAR (Responsive Grid/Flex) -->
      <div
        class="flex flex-col md:flex-row items-start justify-between gap-3 w-full pointer-events-none"
      >
        <!-- 1. Info Panel (Left) - Fixed width on mobile to prevent overlap -->
        <div
          class="pointer-events-auto glass-tech p-3 rounded-bl-xl border-l-4 border-cyan-500 max-w-[240px] md:max-w-xs shadow-lg"
        >
          <h1
            class="text-lg md:text-2xl font-bold text-white uppercase tracking-widest flex items-center gap-2 text-glow"
          >
            <span class="text-cyan-400">///</span>
            <span data-i18n="title">The Grid Social</span>
          </h1>
          <p
            class="text-xs text-cyan-100/70 mt-1 leading-relaxed font-light hidden md:block"
            data-i18n="subtitle"
          >
            A global neural network of human thoughts.
          </p>
          <div
            class="mt-2 flex items-center gap-2 text-xs font-mono text-cyan-400 border border-cyan-900/50 bg-black/50 px-2 py-1 w-fit"
          >
            <span
              class="w-2 h-2 bg-green-500 rounded-full animate-pulse"
            ></span>
            <span id="total-msgs">0000</span>
            <span data-i18n="msgs_label">NODES</span>
          </div>
          <div
            id="top-countries"
            class="mt-2 text-xs font-mono text-cyan-200/60 space-y-1 hidden md:block"
          >
            Loading stats...
          </div>
        </div>

        <!-- Right Side Container (Search + Countdown + MotD) -->
        <div
          class="flex flex-col items-end gap-2 absolute top-2 right-2 md:static pointer-events-none"
        >
          <!-- 2. Countdown -->
          <div
            class="pointer-events-auto glass-tech px-4 py-1 rounded-full border border-red-500/50 flex items-center gap-2 shadow-[0_0_10px_rgba(239,68,68,0.3)]"
            title="Messages are wiped daily. Clan stats persist."
          >
            <div class="w-2 h-2 bg-red-500 rounded-full animate-ping"></div>
            <div
              class="text-red-400 font-mono text-xs tracking-widest whitespace-nowrap"
            >
              DAILY WIPE:
              <span id="countdown-timer" class="text-white font-bold"
                >00:00:00</span
              >
            </div>
          </div>

          <!-- 3. Search -->
          <div class="pointer-events-auto w-48 md:w-64 relative group">
            <input
              type="text"
              id="search-input"
              class="w-full bg-black/60 backdrop-blur-sm border border-cyan-500/50 text-cyan-400 text-xs md:text-sm p-2 pl-8 rounded-none focus:outline-none focus:border-cyan-400 focus:bg-black/80 focus:shadow-[0_0_15px_rgba(6,182,212,0.3)] font-mono uppercase placeholder-cyan-800 transition-all"
              placeholder="SEARCH SIGNAL..."
            />
            <span
              class="absolute left-2 top-1/2 -translate-y-1/2 text-cyan-600 group-focus-within:text-cyan-400"
              >üîç</span
            >
            <ul
              id="search-results"
              class="hidden absolute top-full left-0 w-full max-h-60 overflow-y-auto bg-black/90 border border-cyan-900 mt-1 text-xs font-mono z-50 shadow-xl custom-scrollbar"
            ></ul>
          </div>

          <!-- Message of the Day (MotD) -->
          <div
            id="motd-container"
            class="hidden pointer-events-auto w-48 md:w-64 glass-tech p-3 border-r-4 border-yellow-500 shadow-lg transition-all hover:bg-black/80 cursor-pointer"
            onclick="locateMotD()"
          >
            <div
              class="text-[10px] text-yellow-500 font-bold uppercase tracking-widest mb-1 flex justify-between"
            >
              <span>‚òÖ MESSAGE OF THE DAY</span>
              <span class="animate-pulse">‚óè</span>
            </div>
            <div
              id="motd-content"
              class="text-xs text-white font-mono italic line-clamp-2"
            >
              "Loading transmission..."
            </div>
          </div>
        </div>
      </div>

      <!-- BOTTOM BAR -->
      <div
        class="flex flex-col md:flex-row items-center md:items-end justify-end w-full gap-4 pointer-events-none"
      >
        <!-- 4. Main Action (Center) -->
        <div
          class="pointer-events-auto w-full md:w-auto flex justify-center order-1 md:order-1"
        >
          <button
            id="btn-open-modal"
            class="bg-cyan-600/90 hover:bg-cyan-500 text-black font-bold py-3 px-8 uppercase tracking-widest transition-all duration-300 backdrop-blur-md flex items-center justify-center gap-3 shadow-[0_0_20px_rgba(6,182,212,0.4)] clip-path-button border border-cyan-400 rounded-full w-full md:w-auto"
          >
            <span class="text-xl">‚äï</span>
            <span data-i18n="btn_action">INITIALIZE UPLINK</span>
          </button>
        </div>

        <!-- 5. Controls (Right) -->
        <div
          class="pointer-events-auto flex flex-wrap justify-center md:justify-end gap-2 order-2 md:order-2 w-full md:w-auto"
        >
          <div
            class="glass-tech p-2 flex gap-2 rounded-lg flex-wrap justify-center md:justify-end w-full md:w-auto"
          >
            <button
              onclick="toggleAudio()"
              id="btn-audio"
              class="px-3 py-1 text-xs font-bold text-cyan-400 hover:text-white transition uppercase border border-cyan-900 hover:border-cyan-500"
            >
              üîá OFF
            </button>
            <button
              id="btn-toggle-feed"
              class="px-3 py-1 text-xs font-bold text-cyan-400 hover:text-white transition uppercase border border-cyan-900 hover:border-cyan-500"
            >
              Œû FEED
            </button>
            <button
              id="btn-profile"
              class="px-3 py-1 text-xs font-bold text-yellow-500 hover:text-white transition uppercase border border-yellow-900 hover:border-yellow-500"
            >
              üë§ PROFILE
            </button>
            <button
              onclick="openLevelsModal()"
              class="px-3 py-1 text-xs font-bold text-cyan-400 hover:text-white transition uppercase border border-cyan-900 hover:border-cyan-500"
            >
              ‚ÑπÔ∏è SYSTEM
            </button>
            <button
              onclick="openClanChat()"
              id="btn-clan-chat"
              class="hidden px-3 py-1 text-xs font-bold text-green-500 hover:text-white transition uppercase border border-green-700 hover:border-green-500 shadow-[0_0_10px_rgba(34,197,94,0.2)]"
            >
              üí¨ CLAN CHAT
            </button>
            <button
              onclick="openClanLeaderboard()"
              id="btn-clans"
              class="px-3 py-1 text-xs font-bold text-red-500 hover:text-white transition uppercase border border-red-700 hover:border-red-500 shadow-[0_0_10px_rgba(239,68,68,0.2)]"
            >
              ‚öîÔ∏è CLANS
            </button>
            <button
              onclick="openHallOfFame()"
              id="btn-hall-of-fame"
              class="px-3 py-1 text-xs font-bold text-yellow-500 hover:text-white transition uppercase border border-yellow-700 hover:border-yellow-500 shadow-[0_0_10px_rgba(234,179,8,0.2)]"
            >
              üèÜ HALL OF FAME
            </button>
            <button
              onclick="toggleAutoPilot()"
              id="btn-autopilot"
              class="px-3 py-1 text-xs font-bold text-cyan-400 hover:text-white transition uppercase border border-cyan-900 hover:border-cyan-500"
            >
              AUTO PILOT
            </button>
            <button
              onclick="toggleHistoryMode()"
              id="btn-history"
              class="px-3 py-1 text-xs font-bold text-cyan-400 hover:text-white transition uppercase border border-cyan-900 hover:border-cyan-500"
            >
              HISTORY
            </button>
            <button
              onclick="switchFilter('timestamp')"
              id="filter-latest"
              class="px-3 py-1 text-xs font-bold bg-cyan-600 text-black rounded hover:bg-cyan-500 transition uppercase"
            >
              LATEST
            </button>
            <button
              onclick="switchFilter('likes')"
              id="filter-top"
              class="px-3 py-1 text-xs font-bold text-cyan-400 hover:text-white transition uppercase"
            >
              TOP RATED
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- History Timeline UI (Hidden by default) -->
    <div
      id="history-ui"
      class="hidden fixed bottom-0 left-0 w-full z-[1100] p-4 pointer-events-auto"
    >
      <div
        class="glass-tech p-4 rounded-t-2xl border-t border-cyan-500 flex flex-col gap-2 max-w-3xl mx-auto"
      >
        <div
          class="flex justify-between items-center text-cyan-400 font-mono text-xs uppercase tracking-widest"
        >
          <span>TIMELINE MODE</span>
          <span id="history-date">LOADING DATA...</span>
          <button
            onclick="toggleHistoryMode()"
            class="text-red-500 hover:text-red-400"
          >
            [ EXIT ]
          </button>
        </div>

        <input
          type="range"
          id="history-slider"
          min="0"
          max="100"
          value="0"
          class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-cyan-500"
        />

        <div class="flex justify-center gap-4 mt-2">
          <button
            onclick="navHistory(-1)"
            class="px-4 py-2 bg-black/50 border border-cyan-900 text-cyan-400 hover:bg-cyan-900/50 rounded uppercase text-xs font-bold"
          >
            PREV
          </button>
          <button
            onclick="togglePlayHistory()"
            id="btn-play-history"
            class="px-6 py-2 bg-cyan-600 text-black hover:bg-cyan-500 rounded uppercase text-xs font-bold shadow-[0_0_10px_rgba(6,182,212,0.4)]"
          >
            PLAY
          </button>
          <button
            onclick="navHistory(1)"
            class="px-4 py-2 bg-black/50 border border-cyan-900 text-cyan-400 hover:bg-cyan-900/50 rounded uppercase text-xs font-bold"
          >
            NEXT
          </button>
        </div>
        <div class="text-center text-xs text-gray-500 font-mono mt-1">
          <span id="history-counter">0 / 0</span> NODES
        </div>
      </div>
    </div>

    <!-- PROFILE MODAL -->
    <div
      id="modal-profile"
      class="hidden fixed inset-0 bg-black/80 z-[5000] flex items-center justify-center p-4 backdrop-blur-sm"
    >
      <div
        class="glass-tech w-full max-w-2xl p-6 border-y-4 border-yellow-500 relative max-h-[90vh] overflow-y-auto custom-scrollbar"
      >
        <!-- Close Button -->
        <button
          id="btn-close-profile"
          class="absolute top-4 right-4 text-yellow-600 hover:text-yellow-400 transition text-xl font-mono"
        >
          [X]
        </button>

        <!-- Header -->
        <div
          class="flex justify-between items-center mb-8 border-b border-gray-800 pb-4"
        >
          <h2
            class="text-3xl font-bold text-yellow-500 uppercase tracking-widest text-glow"
          >
            OPERATOR PROFILE
          </h2>
        </div>

        <!-- Content -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <!-- Left: Avatar & Stats -->
          <div class="flex flex-col items-center text-center space-y-4">
            <div
              class="w-32 h-32 rounded-full border-4 border-yellow-500/50 bg-black flex items-center justify-center shadow-[0_0_20px_rgba(234,179,8,0.2)]"
            >
              <span class="text-5xl">üë§</span>
            </div>
            <div>
              <div
                id="profile-email-display"
                class="text-gray-400 font-mono text-sm"
              >
                loading...
              </div>
              <div
                class="text-xs text-yellow-600 mt-1 uppercase tracking-widest"
              >
                Verified Node
              </div>
            </div>
            <div class="flex justify-around text-center mt-4 w-full gap-4">
              <div>
                <div
                  class="font-bold text-xl text-white"
                  id="profile-followers"
                >
                  0
                </div>
                <div class="text-xs text-gray-400 uppercase">Followers</div>
              </div>
              <div>
                <div
                  class="font-bold text-xl text-white"
                  id="profile-following"
                >
                  0
                </div>
                <div class="text-xs text-gray-400 uppercase">Following</div>
              </div>
            </div>
          </div>

          <!-- Right: Edit Form -->
          <div class="space-y-6">
            <div>
              <label
                class="block text-xs font-bold text-gray-500 uppercase mb-1"
                >Display Name / Codename</label
              >
              <input
                type="text"
                id="profile-name"
                class="auth-input bg-black/50"
                placeholder="Enter codename..."
              />
            </div>

            <div>
              <label
                class="block text-xs font-bold text-gray-500 uppercase mb-1"
                >System ID</label
              >
              <div
                id="profile-uid"
                class="p-3 bg-black/30 border border-gray-800 font-mono text-xs text-gray-500 break-all"
              >
                ...
              </div>
            </div>

            <button
              id="btn-save-profile"
              class="w-full bg-yellow-600 hover:bg-yellow-500 text-black font-bold py-3 uppercase tracking-widest transition shadow-[0_0_15px_rgba(234,179,8,0.3)]"
            >
              UPDATE DATA
            </button>
          </div>
        </div>

        <!-- Danger Zone -->
        <div class="mt-12 pt-6 border-t border-red-900/30">
          <h3 class="text-red-500 font-bold uppercase text-sm mb-4">
            DANGER ZONE
          </h3>
          <div class="flex flex-col md:flex-row gap-4">
            <button
              id="btn-logout"
              class="flex-1 border border-gray-600 text-gray-400 hover:text-white hover:border-white py-3 uppercase text-xs font-bold transition"
            >
              DISCONNECT SESSION
            </button>
            <button
              id="btn-delete-account"
              class="flex-1 border border-red-900 text-red-800 hover:bg-red-900 hover:text-white py-3 uppercase text-xs font-bold transition"
            >
              DELETE ACCOUNT PERMANENTLY
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Public Profile Modal -->
    <div
      id="modal-public-profile"
      class="hidden fixed inset-0 bg-black/80 z-[5100] flex items-center justify-center p-4 backdrop-blur-sm"
    >
      <div
        class="glass-tech w-full max-w-sm p-6 border-t-4 border-cyan-500 relative"
      >
        <button
          onclick="closePublicProfile()"
          class="absolute top-4 right-4 text-cyan-600 hover:text-cyan-400"
        >
          [X]
        </button>

        <div class="flex flex-col items-center text-center">
          <div
            class="w-24 h-24 rounded-full border-2 border-cyan-500/50 bg-black flex items-center justify-center mb-4"
          >
            <span class="text-4xl">üë§</span>
          </div>
          <h2
            id="public-profile-name"
            class="text-2xl font-bold text-white uppercase tracking-widest text-glow"
          >
            Operator
          </h2>

          <div class="flex gap-6 my-4 font-mono text-center">
            <div>
              <div
                id="public-profile-followers"
                class="text-xl font-bold text-white"
              >
                0
              </div>
              <div class="text-xs text-gray-400 uppercase">Followers</div>
            </div>
            <div>
              <div
                id="public-profile-following"
                class="text-xl font-bold text-white"
              >
                0
              </div>
              <div class="text-xs text-gray-400 uppercase">Following</div>
            </div>
          </div>

          <div class="w-full mt-2">
            <button
              id="btn-public-follow"
              class="w-full bg-cyan-900/50 border border-cyan-500 text-cyan-400 hover:bg-cyan-500 hover:text-black py-2 font-bold uppercase text-xs transition"
            >
              FOLLOW
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Levels/Gamification Modal -->
    <div
      id="modal-levels"
      class="hidden fixed inset-0 bg-black/90 z-[5000] flex items-center justify-center p-4 backdrop-blur-md"
    >
      <div
        class="glass-tech w-full max-w-2xl p-6 relative border-y-4 border-cyan-500 max-h-[90vh] overflow-y-auto custom-scrollbar"
      >
        <button
          onclick="closeLevelsModal()"
          class="absolute top-4 right-4 text-cyan-600 hover:text-cyan-400 transition text-xl font-mono"
        >
          [X]
        </button>
        <h2
          class="text-3xl font-bold text-cyan-500 uppercase tracking-widest text-center mb-6 text-glow"
        >
          /// SYSTEM LEVELS
        </h2>

        <div class="space-y-6 font-mono text-sm">
          <!-- Level 1 -->
          <div
            class="flex items-center gap-4 p-4 bg-black/40 border border-cyan-900/30"
          >
            <div
              class="w-4 h-4 rounded-full bg-cyan-500 shadow-[0_0_10px_#06b6d4]"
            ></div>
            <div>
              <div class="text-cyan-400 font-bold uppercase">
                SIGNAL: ACTIVE
              </div>
              <div class="text-gray-400 text-xs">0 - 9 Likes</div>
              <div class="text-gray-500 text-xs mt-1">
                Standard visibility on the grid.
              </div>
            </div>
          </div>

          <!-- Level 2 -->
          <div
            class="flex items-center gap-4 p-4 bg-black/40 border border-purple-900/30"
          >
            <div
              class="w-5 h-5 rounded-full bg-purple-500 shadow-[0_0_15px_#a855f7]"
            ></div>
            <div>
              <div class="text-purple-400 font-bold uppercase">
                SIGNAL: VETERAN
              </div>
              <div class="text-gray-400 text-xs">10 - 49 Likes</div>
              <div class="text-gray-500 text-xs mt-1">
                Enhanced marker size. [VETERAN] tag.
              </div>
            </div>
          </div>

          <!-- Level 3 -->
          <div
            class="flex items-center gap-4 p-4 bg-black/40 border border-yellow-900/30"
          >
            <div
              class="w-6 h-6 rounded-full bg-yellow-500 shadow-[0_0_20px_#eab308]"
            ></div>
            <div>
              <div class="text-yellow-500 font-bold uppercase">
                SIGNAL: LEGEND
              </div>
              <div class="text-gray-400 text-xs">50+ Likes</div>
              <div class="text-gray-500 text-xs mt-1">
                Maximum visibility. [LEGEND] tag. Unlocks rewards.
              </div>
            </div>
          </div>

          <!-- Clans -->
          <div class="p-4 border-t border-cyan-900/50 mt-4">
            <h3 class="text-white font-bold uppercase mb-2">CLAN PROTOCOLS</h3>
            <p class="text-gray-400 text-xs mb-2">
              Add a tag like <span class="text-white">[CYBER]</span> to your
              name to join a clan.
            </p>
            <ul class="list-disc list-inside text-gray-500 text-xs space-y-1">
              <li>Clan score = Total likes of all members.</li>
              <li>Access to encrypted Clan Chat.</li>
              <li>Dominate the leaderboard.</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- THREAD / REPLY MODAL -->
    <div
      id="modal-thread"
      class="hidden fixed inset-0 bg-black/80 z-[5500] flex items-center justify-center p-4 backdrop-blur-sm"
    >
      <div
        class="glass-tech w-full max-w-lg h-[80vh] flex flex-col border-y-4 border-cyan-500 relative"
      >
        <div
          class="p-4 border-b border-cyan-900 bg-black/60 flex justify-between items-center"
        >
          <h3 class="text-cyan-400 font-bold uppercase tracking-widest">
            /// DATA THREAD
          </h3>
          <button id="btn-close-thread" class="text-cyan-600 hover:text-white">
            [X]
          </button>
        </div>

        <!-- Original Message -->
        <div
          id="thread-original"
          class="p-4 bg-cyan-900/10 border-b border-cyan-900/50"
        >
          <!-- Injected via JS -->
        </div>

        <!-- Replies List -->
        <div
          id="thread-replies"
          class="flex-1 overflow-y-auto p-4 space-y-3 custom-scrollbar"
        >
          <!-- Injected via JS -->
        </div>

        <!-- Reply Input -->
        <div class="p-4 bg-black/80 border-t border-cyan-900 flex gap-2">
          <input
            type="text"
            id="reply-input"
            class="flex-1 bg-black border border-cyan-800 text-cyan-100 p-2 text-sm outline-none focus:border-cyan-500"
            placeholder="Reply to signal..."
          />
          <button
            id="btn-send-reply"
            class="bg-cyan-700 text-white px-4 font-bold text-xs uppercase hover:bg-cyan-500"
          >
            SEND
          </button>
        </div>
      </div>
    </div>

    <!-- Modal de Formul√°rio -->
    <div
      id="modal-form"
      class="hidden fixed inset-0 bg-black/40 z-[2000] flex items-center justify-center p-4 backdrop-blur-sm transition-opacity"
    >
      <div
        class="glass-tech w-full max-w-md p-8 relative border-t-4 border-t-cyan-500"
      >
        <button
          id="btn-close-modal"
          class="absolute top-4 right-4 text-cyan-700 hover:text-cyan-400 transition text-xl font-mono"
        >
          [X]
        </button>

        <h2
          class="text-3xl font-bold mb-1 text-white uppercase tracking-wider text-glow"
          data-i18n="modal_title"
        >
          TRANSMISSION
        </h2>
        <p
          class="text-sm text-cyan-200/60 mb-8 font-mono"
          data-i18n="modal_desc"
        >
          Establishing secure connection to current coordinates.
        </p>

        <div class="space-y-6">
          <div>
            <label
              class="block text-xs font-bold text-cyan-500 uppercase tracking-widest mb-2"
              data-i18n="label_name"
              >CODENAME / ID</label
            >
            <input
              type="text"
              id="input-name"
              class="w-full p-3 bg-black/50 border border-cyan-900 text-cyan-100 focus:border-cyan-400 focus:shadow-[0_0_10px_rgba(6,182,212,0.3)] outline-none transition font-mono"
              placeholder="Identity..."
              data-i18n-placeholder="ph_name"
            />
          </div>

          <div>
            <label
              class="block text-xs font-bold text-cyan-500 uppercase tracking-widest mb-2"
              data-i18n="label_msg"
              >DATA PACKET</label
            >
            <textarea
              id="input-msg"
              rows="3"
              maxlength="140"
              class="w-full p-3 bg-black/50 border border-cyan-900 text-cyan-100 focus:border-cyan-400 focus:shadow-[0_0_10px_rgba(6,182,212,0.3)] outline-none transition resize-none font-mono"
              placeholder="Input data stream..."
              data-i18n-placeholder="ph_msg"
            ></textarea>
            <div class="text-right text-xs text-cyan-700 mt-1 font-mono">
              <span id="char-count">0</span>/140
            </div>
          </div>

          <button
            id="btn-submit"
            class="w-full bg-cyan-600 hover:bg-cyan-500 text-black font-bold py-4 uppercase tracking-widest transition shadow-[0_0_15px_rgba(6,182,212,0.4)] disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center gap-2 clip-path-button"
          >
            <span data-i18n="btn_submit">UPLOAD TO GRID</span> üì°
          </button>
        </div>
      </div>
    </div>

    <!-- Modal de Compartilhamento -->
    <div
      id="modal-share"
      class="hidden fixed inset-0 bg-black/60 z-[2000] flex items-center justify-center p-4 backdrop-blur-sm"
    >
      <div
        class="glass-tech w-full max-w-sm p-8 text-center border-b-4 border-b-green-500"
      >
        <div
          class="w-16 h-16 border-2 border-green-500 text-green-500 rounded-full flex items-center justify-center mx-auto mb-6 text-3xl shadow-[0_0_15px_rgba(34,197,94,0.4)]"
        >
          ‚úì
        </div>
        <h2
          class="text-2xl font-bold text-white mb-2 uppercase tracking-widest"
          data-i18n="success_title"
        >
          UPLOAD COMPLETE
        </h2>
        <p
          class="text-cyan-200/60 mb-8 text-sm font-mono"
          data-i18n="success_desc"
        >
          Your data node has been synchronized globally.
        </p>

        <!-- Sponsor / Reward Banner -->
        <div
          id="sponsor-banner"
          class="mb-6 p-3 bg-black/40 border border-dashed border-gray-700 rounded relative overflow-hidden group"
        >
          <div id="reward-locked" class="text-xs">
            <div class="text-gray-400 uppercase tracking-widest mb-1">
              LOCKED REWARD
            </div>
            <div class="text-cyan-600 font-mono">
              Reach
              <span class="text-yellow-500 font-bold">LEGEND LEVEL</span> (50
              Likes) to unlock exclusive partner coupons.
            </div>
            <div
              class="w-full h-1 bg-gray-800 mt-2 rounded-full overflow-hidden"
            >
              <div class="h-full bg-yellow-500 w-1/4"></div>
            </div>
          </div>
          <div id="reward-unlocked" class="hidden">
            <div class="absolute inset-0 bg-yellow-500/10 animate-pulse"></div>
            <div
              class="text-yellow-500 font-bold uppercase tracking-widest mb-1 text-glow"
            >
              ‚òÖ LEGEND REWARD UNLOCKED ‚òÖ
            </div>
            <div class="text-white font-mono text-sm mb-1">
              Use code:
              <span
                class="bg-yellow-500 text-black px-2 py-0.5 font-bold select-all"
                >CYBER50</span
              >
            </div>
            <div class="text-[10px] text-gray-400">
              50% OFF at CyberWear Store
            </div>
          </div>
        </div>

        <div class="space-y-4 font-mono text-sm">
          <button
            onclick="share('whatsapp')"
            class="w-full border border-[#25D366] text-[#25D366] hover:bg-[#25D366] hover:text-black py-3 px-4 font-bold transition flex items-center justify-center gap-2 uppercase"
          >
            WhatsApp Protocol
          </button>
          <button
            onclick="share('twitter')"
            class="w-full border border-white text-white hover:bg-white hover:text-black py-3 px-4 font-bold transition flex items-center justify-center gap-2 uppercase"
          >
            X / Twitter Feed
          </button>
          <button
            onclick="copyLink()"
            class="w-full border border-gray-600 text-gray-400 hover:border-cyan-400 hover:text-cyan-400 py-3 px-4 font-bold transition uppercase"
          >
            Copy Frequency Link
          </button>
          <button
            onclick="downloadCard()"
            class="w-full border border-cyan-500 text-cyan-400 hover:bg-cyan-500 hover:text-black py-3 px-4 font-bold transition uppercase"
          >
            Download Data Card üì∏
          </button>
        </div>

        <button
          id="btn-close-share"
          class="mt-8 text-xs text-cyan-800 hover:text-cyan-500 uppercase tracking-widest"
          data-i18n="btn_close"
        >
          [ Close Terminal ]
        </button>
      </div>
    </div>

    <!-- Modal Welcome (First Visit) -->
    <div
      id="modal-welcome"
      class="hidden fixed inset-0 bg-black/90 z-[4000] flex items-center justify-center p-4 backdrop-blur-md transition-opacity"
    >
      <div
        class="glass-tech w-full max-w-2xl p-8 relative border-y-4 border-cyan-500 max-h-[90vh] overflow-y-auto"
      >
        <button
          id="btn-close-welcome"
          class="absolute top-4 right-4 text-cyan-700 hover:text-cyan-400 transition text-xl font-mono"
        >
          [X]
        </button>
        <h1
          class="text-4xl font-bold text-white uppercase tracking-widest text-glow mb-6 text-center"
        >
          <span class="text-cyan-400">///</span> SYSTEM INITIALIZED
        </h1>

        <div class="space-y-6 text-cyan-100/80 font-mono">
          <p class="text-lg leading-relaxed text-center">
            Welcome to
            <strong class="text-white">The Grid Social</strong>.<br />
            You have connected to a global neural network of human thoughts.
          </p>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-black/40 p-4 border border-cyan-900/50">
              <h3 class="text-cyan-400 font-bold uppercase mb-2 text-sm">
                /// DIRECTIVES
              </h3>
              <ul class="list-disc list-inside space-y-2 text-sm">
                <li>Leave your mark on the global grid.</li>
                <li>Connect with nodes from around the world.</li>
                <li>
                  Join a Clan by adding
                  <span class="text-red-400">[TAG]</span> to your name.
                </li>
                <li>
                  Access exclusive <strong>Clan Chat</strong> when you have a
                  tag.
                </li>
                <li>Gain reputation (Likes) to upgrade your signal level.</li>
              </ul>
            </div>

            <div class="bg-black/40 p-4 border border-cyan-900/50">
              <h3 class="text-cyan-400 font-bold uppercase mb-2 text-sm">
                /// PROTOCOLS
              </h3>
              <div class="flex flex-wrap gap-2 text-xl" id="welcome-flags">
                <!-- Flags injected via JS -->
              </div>
              <div class="mt-2 text-xs text-cyan-500">
                Auto-translation active. Daily message wipe (Clan stats
                persist).
              </div>
            </div>
          </div>

          <div class="text-center pt-4">
            <p class="text-xs uppercase tracking-widest text-cyan-600 mb-2">
              CURRENT NETWORK STATUS
            </p>
            <div class="text-3xl font-bold text-white text-glow">
              <span id="welcome-total-msgs">CONNECTING...</span> NODES ACTIVE
            </div>
          </div>
        </div>

        <button
          id="btn-enter-site"
          class="w-full mt-8 bg-cyan-600 hover:bg-cyan-500 text-black font-bold py-4 uppercase tracking-widest transition shadow-[0_0_20px_rgba(6,182,212,0.4)]"
        >
          ENTER THE GRID
        </button>
      </div>
    </div>

    <!-- Hall of Fame Modal -->
    <div
      id="modal-hall-of-fame"
      class="hidden fixed inset-0 bg-black/90 z-[5000] flex items-center justify-center p-4 backdrop-blur-md"
    >
      <div
        class="glass-tech w-full max-w-2xl p-6 relative border-y-4 border-yellow-500 max-h-[90vh] overflow-y-auto custom-scrollbar"
      >
        <button
          onclick="closeHallOfFame()"
          class="absolute top-4 right-4 text-yellow-600 hover:text-yellow-400 transition text-xl font-mono"
        >
          [X]
        </button>
        <h2
          class="text-3xl font-bold text-yellow-500 uppercase tracking-widest text-center mb-2 text-glow"
        >
          üèÜ HALL OF FAME üèÜ
        </h2>
        <p class="text-center text-yellow-200/60 font-mono text-xs mb-6">
          THE MOST LEGENDARY SIGNALS IN THE GRID
        </p>
        <div id="hall-of-fame-list" class="space-y-3">
          <!-- Items injected via JS -->
        </div>
      </div>
    </div>

    <!-- Clan Leaderboard Modal -->
    <div
      id="modal-clans"
      class="hidden fixed inset-0 bg-black/90 z-[5000] flex items-center justify-center p-4 backdrop-blur-md"
    >
      <div
        class="glass-tech w-full max-w-2xl p-6 relative border-y-4 border-red-500 max-h-[90vh] overflow-y-auto custom-scrollbar"
      >
        <button
          onclick="closeClanLeaderboard()"
          class="absolute top-4 right-4 text-red-600 hover:text-red-400 transition text-xl font-mono"
        >
          [X]
        </button>
        <h2
          class="text-3xl font-bold text-red-500 uppercase tracking-widest text-center mb-2 text-glow"
        >
          ‚öîÔ∏è CLAN WARS ‚öîÔ∏è
        </h2>
        <p class="text-center text-red-200/60 font-mono text-xs mb-6">
          DOMINANT FACTIONS IN THE NETWORK
        </p>
        <div id="clan-list" class="space-y-3">
          <!-- Items injected via JS -->
        </div>
        <div
          id="clan-rivalry"
          class="hidden mt-6 p-4 bg-red-900/20 border border-red-500/30 rounded text-center"
        >
          <!-- Rivalry info injected via JS -->
        </div>
        <div
          class="mt-6 p-4 bg-black/40 border border-cyan-900/50 rounded text-center"
        >
          <h3 class="text-cyan-400 font-bold uppercase text-sm mb-2">
            JOIN THE CLAN WARS
          </h3>
          <p class="text-cyan-200/70 text-xs font-mono mb-4">
            To join or create a clan, add a tag like
            <span class="text-white font-bold">[CYBER]</span> to your Display
            Name in your profile.
          </p>
          <button
            onclick="window.location.href = 'src/view/profile.html'"
            class="w-full bg-cyan-600 hover:bg-cyan-500 text-black font-bold py-2 uppercase tracking-widest transition text-xs"
          >
            GO TO PROFILE
          </button>
        </div>
      </div>
    </div>

    <!-- Clan Chat Modal -->
    <div
      id="modal-clan-chat"
      class="hidden fixed inset-0 bg-black/80 z-[5000] flex items-center justify-center p-4 backdrop-blur-sm"
    >
      <div
        class="glass-tech w-full max-w-md h-[500px] flex flex-col relative border-y-4 border-green-500"
      >
        <button
          onclick="closeClanChat()"
          class="absolute top-4 right-4 text-green-500 hover:text-white transition text-xl font-mono z-10"
        >
          [X]
        </button>
        <div class="p-4 border-b border-green-900/50 bg-black/40">
          <h2
            class="text-xl font-bold text-green-500 uppercase tracking-widest text-glow"
          >
            /// CLAN COMMS
          </h2>
          <div class="text-xs text-green-800 font-mono" id="clan-chat-tag">
            ENCRYPTED CHANNEL
          </div>
        </div>
        <div
          id="clan-chat-messages"
          class="flex-1 overflow-y-auto p-4 space-y-2 font-mono text-sm custom-scrollbar"
        >
          <!-- Messages -->
        </div>
        <div class="p-4 bg-black/60 border-t border-green-900/50 flex gap-2">
          <input
            type="text"
            id="clan-chat-input"
            class="flex-1 bg-black/50 border border-green-900 text-green-400 text-xs p-2 focus:border-green-500 outline-none"
            placeholder="TRANSMIT..."
          />
          <button
            onclick="sendClanMessage()"
            class="bg-green-900/30 text-green-500 border border-green-700 hover:bg-green-500 hover:text-black px-3 font-bold text-xs uppercase"
          >
            SEND
          </button>
        </div>
      </div>
    </div>

    <!-- Hidden Card for Generation -->
    <div
      id="share-card-container"
      class="fixed top-0 left-0 -z-50 opacity-0 pointer-events-none"
    >
      <div
        id="share-card"
        class="w-[600px] h-[315px] bg-black border-4 border-cyan-500 p-8 flex flex-col justify-between relative overflow-hidden"
      >
        <!-- Background Grid -->
        <div
          class="absolute inset-0 opacity-20"
          style="
            background-image:
              linear-gradient(#06b6d4 1px, transparent 1px),
              linear-gradient(90deg, #06b6d4 1px, transparent 1px);
            background-size: 20px 20px;
          "
        ></div>

        <div class="relative z-10">
          <h1
            class="text-4xl font-bold text-white uppercase tracking-widest text-glow mb-2"
          >
            <span class="text-cyan-400">///</span> THE GRID SOCIAL
          </h1>
          <div class="text-cyan-400 font-mono text-sm">
            SECURE TRANSMISSION // <span id="card-date"></span>
          </div>
        </div>

        <div
          class="relative z-10 bg-black/80 border border-cyan-500/50 p-6 backdrop-blur-sm"
        >
          <div
            class="text-cyan-300 font-bold text-xl mb-2 uppercase glitch-static"
            id="card-name"
          >
            CODENAME
          </div>
          <div
            class="text-white text-2xl font-light leading-relaxed glitch-static"
            id="card-text"
          >
            "Message content goes here..."
          </div>
        </div>

        <div class="relative z-10 text-right font-mono text-xs text-gray-500">
          COORDS:
          <span id="card-coords" class="text-cyan-500">00.00, 00.00</span>
        </div>
      </div>
    </div>

    <!-- Toast Container (Notifications) -->
    <div
      id="toast-container"
      class="fixed top-4 right-4 z-[9999] flex flex-col gap-2 pointer-events-none"
    ></div>

    <!-- Custom Confirm Modal -->
    <div
      id="custom-confirm"
      class="hidden fixed inset-0 bg-black/80 z-[9999] flex items-center justify-center p-4 backdrop-blur-sm"
    >
      <div
        class="glass-tech w-full max-w-sm p-6 border-t-4 border-red-500 relative"
      >
        <h3 class="text-xl font-bold text-white uppercase mb-4 text-glow">
          CONFIRM ACTION
        </h3>
        <p id="confirm-msg" class="text-gray-300 font-mono text-sm mb-6">
          Are you sure?
        </p>
        <div class="flex gap-3 justify-end">
          <button
            id="btn-confirm-cancel"
            class="px-4 py-2 border border-gray-600 text-gray-400 hover:text-white text-xs font-bold uppercase transition"
          >
            CANCEL
          </button>
          <button
            id="btn-confirm-ok"
            class="px-4 py-2 bg-red-600 text-white hover:bg-red-500 text-xs font-bold uppercase shadow-[0_0_10px_rgba(220,38,38,0.4)] transition"
          >
            PROCEED
          </button>
        </div>
      </div>
    </div>

    <!-- Leaflet JS -->
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>

    <script type="module" src="js/app.js"></script>
  </body>
</html>
